(this.webpackJsonpwebgl=this.webpackJsonpwebgl||[]).push([[0],{13:function(e,t,a){e.exports=a(19)},18:function(e,t,a){},19:function(e,t,a){"use strict";a.r(t);var n=a(2),i=a.n(n),o=a(12),r=a.n(o),s=(a(18),a(5)),c=a(6),l=a(9),h=a(8),u=a(4),d=a(10),f=function(e){var t=e.message,a=e.onClick;return t?i.a.createElement("div",{id:"message",onClick:a},t.map((function(e,t){return i.a.createElement("div",{key:t},e)}))):null},m=function(e){var t=e.control;return i.a.createElement("div",{className:"control"},t.description)},g=function(e){for(var t=e.control,a=[],n=0;n<t.options.length;n++)a.push(i.a.createElement("option",{key:n,value:n},t.options[n]));return i.a.createElement("div",{className:"control"},i.a.createElement("label",{htmlFor:t.name},t.name),i.a.createElement("select",{id:t.name,className:"select-css",value:t.value,onChange:function(a){e.onChange(t,a.target.value)}},a))},p=function(e){var t=e.control;return i.a.createElement("div",{className:"control"},i.a.createElement("label",{className:"clickable",htmlFor:t.name},i.a.createElement("input",{className:"clickable",id:t.name,type:"checkbox",checked:t.value,onChange:function(a){e.onChange(t,a.target.checked)}}),t.name))},v=function(e){var t=e.control;return i.a.createElement("div",{className:"control"},i.a.createElement("label",{htmlFor:t.name},t.name," ",t.value),i.a.createElement("input",{id:t.name,className:"clickable",type:"range",min:t.min,max:t.max,value:t.value,onChange:function(a){e.onChange(t,a.target.value)}}))},b=function(e){var t=1e3;var a=e.control;return i.a.createElement("div",{className:"control"},i.a.createElement("label",{htmlFor:a.name},a.name," ",a.value.toFixed(3)),i.a.createElement("input",{id:a.name,className:"clickable",type:"range",min:Math.floor(a.min*t),max:Math.floor(a.max*t),value:Math.floor(a.value*t),onChange:function(n){e.onChange(a,n.target.value/t)}}))},x=function(e){var t=e.control;return i.a.createElement("div",{className:"control"},i.a.createElement("button",{onClick:function(e){t.function()}},t.name))},y=function(e){var t,a=e.show,n=e.onClickPrevious,o=e.onClickNext,r=e.onChange,s=e.options;return a?(s&&(t=s.map((function(e,t){switch(e.type){case"description":return i.a.createElement(m,{key:t,control:e});case"select":return i.a.createElement(g,{key:t,control:e,onChange:r});case"bool":return i.a.createElement(p,{key:t,control:e,onChange:r});case"int":return i.a.createElement(v,{key:t,control:e,onChange:r});case"float":return i.a.createElement(b,{key:t,control:e,onChange:r});case"function":return i.a.createElement(x,{key:t,control:e});default:return i.a.createElement("div",{key:t,className:"control"},e.type," is not supported")}}))),i.a.createElement("div",{id:"overlay"},i.a.createElement("div",{className:"none"},i.a.createElement("span",{className:"left",onClick:n},"\u276e PREV"),i.a.createElement("span",{className:"right",onClick:o},"NEXT \u276f")),i.a.createElement("div",null,t))):null},M=function(e){var t,a=e.show,n=e.credits;return a?(n&&(t=n.map((function(e,t){if(e.startsWith("link:")){var a=e.slice(5);return i.a.createElement("div",{key:t,className:"credit"},i.a.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},a))}return""===e?i.a.createElement("div",{key:t,className:"credit"}):i.a.createElement("div",{key:t,className:"credit"},e)}))),i.a.createElement("div",{id:"credits"},t)):null},O=a(0);function w(e){return e*(Math.PI/180)}function L(e,t){switch(t){case e.FLOAT:return"FLOAT";case e.FLOAT_VEC2:return"FLOAT_VEC2";case e.FLOAT_VEC3:return"FLOAT_VEC3";case e.FLOAT_VEC4:return"FLOAT_VEC4";case e.INT:return"INT";case e.INT_VEC2:return"INT_VEC2";case e.INT_VEC3:return"INT_VEC3";case e.INT_VEC4:return"INT_VEC4";case e.BOOL:return"BOOL";case e.BOOL_VEC2:return"BOOL_VEC2";case e.BOOL_VEC3:return"BOOL_VEC3";case e.BOOL_VEC4:return"BOOL_VEC4";case e.FLOAT_MAT2:return"FLOAT_MAT2";case e.FLOAT_MAT3:return"FLOAT_MAT3";case e.FLOAT_MAT4:return"FLOAT_MAT4";case e.SAMPLER_2D:return"SAMPLER_2D";case e.SAMPLER_CUBE:return"SAMPLER_CUBE";default:return"UNKNOWN"}}function _(e,t,a){var n=e.createShader(t);return e.shaderSource(n,a),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)}function k(e,t){var a=e.createTexture();e.bindTexture(e.TEXTURE_2D,a);var n=e.RGBA,i=e.RGBA,o=e.UNSIGNED_BYTE,r=new Uint8Array([0,0,255,255]);e.texImage2D(e.TEXTURE_2D,0,n,1,1,0,i,o,r);var s=new Image;return s.onload=function(){e.bindTexture(e.TEXTURE_2D,a),e.texImage2D(e.TEXTURE_2D,0,n,i,o,s),A(s.width)&&A(s.height)?e.generateMipmap(e.TEXTURE_2D):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR))},s.src=t,a}function A(e){return 0===(e&e-1)}function E(e){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}function S(e){return e[Math.floor(Math.random()*e.length)]}var C=a(1),T=a(7),j=function(){function e(){Object(s.a)(this,e)}return Object(c.a)(e,[{key:"_initModel",value:function(e){var t,a,n=this,i=e.gl,o=e.geometry,r=e.bufferCount,s=[];if(e.texture){var c={};e.texture.diffuse&&(c.diffuse=k(i,e.texture.diffuse)),e.texture.normal&&(c.normal=k(i,e.texture.normal)),e.texture.height&&(c.height=k(i,e.texture.height)),e.texture.occlusion&&(c.occlusion=k(i,e.texture.occlusion)),s.push(c)}else if(e.textures)for(var l=0;l<e.textures.length;l++){var h={};e.textures[l].diffuse&&(h.diffuse=k(i,e.textures[l].diffuse)),e.textures[l].normal&&(h.normal=k(i,e.textures[l].normal)),e.textures[l].height&&(h.height=k(i,e.textures[l].height)),e.textures[l].occlusion&&(h.occlusion=k(i,e.textures[l].occlusion)),s.push(h)}e.shader?Promise.all([fetch(e.shader.vertex).then((function(e){return e.text()})).then((function(e){return t=e})),fetch(e.shader.fragment).then((function(e){return e.text()})).then((function(e){return a=e}))]).then((function(){var e=n._setupShader(i,t,a),c=n._initBuffers(i,[e],o,r||s.length||1);n.model={shaders:[e],buffers:c,textures:s}})):function(){for(var t=new Array(e.shaders.length).fill(null),a=new Array(e.shaders.length).fill(null),c=[],l=function(n){c.push(fetch(e.shaders[n].vertex).then((function(e){return e.text()})).then((function(e){return t[n]=e}))),c.push(fetch(e.shaders[n].fragment).then((function(e){return e.text()})).then((function(e){return a[n]=e})))},h=0;h<e.shaders.length;h++)l(h);Promise.all(c).then((function(){for(var c=[],l=0;l<e.shaders.length;l++)c.push(n._setupShader(i,t[l],a[l]));var h=n._initBuffers(i,c,o,r||s.length||1);n.model={shaders:c,buffers:h,textures:s}}))}()}},{key:"_updateModel",value:function(e){var t=this.model.buffers.length;this._deleteBuffers(),this.model.buffers=this._initBuffers(this.gl,this.model.shaders,e,t)}},{key:"_setupShader",value:function(e,t,a){var n=this,i=function(e,t,a){var n=_(e,e.VERTEX_SHADER,t),i=_(e,e.FRAGMENT_SHADER,a),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,i),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)?o:(alert("Unable to initialize the shader program: "+e.getProgramInfoLog(o)),null)}(e,t,a),o=function(e,t){for(var a=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),n=[],i=0;i<a;i++){var o=e.getActiveAttrib(t,i);n.push({name:o.name,type:L(e,o.type)})}for(var r=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),s=[],c=0;c<r;c++){var l=e.getActiveUniform(t,c);s.push({name:l.name,type:L(e,l.type)})}return{attributes:n,uniforms:s}}(e,i),r={program:i,attribLocations:{},uniformLocations:{}};return o.attributes.forEach((function(t){var a=e.getAttribLocation(i,t.name);n._addShaderNameToJavascript(r.attribLocations,t.name,a)})),o.uniforms.forEach((function(t){var a=e.getUniformLocation(i,t.name);n._addShaderNameToJavascript(r.uniformLocations,t.name,a)})),r}},{key:"_addShaderNameToJavascript",value:function(e,t,a){if("a"===t[0]||"u"===t[0])for(var n=(t[1].toLowerCase()+t.slice(2)).split("."),i=e,o=0;o<n.length;o++){var r=n[o],s=r.indexOf("[");if(-1!==s){var c=r.indexOf("]");if(c<s+2)return void alert("shader name of "+t+" is not valid");var l=Number(r.slice(s+1,c));r=r.slice(0,s),o<n.length-1?(i[r]||(i[r]=[]),i[r].length<=l&&(i[r].length=l+1),i[r][l]||(i[r][l]={}),i=i[r][l]):(i[r]||(i[r]=[]),i[r].length<=l&&(i[r].length=l+1),i[r][l]=a)}else o<n.length-1?(i[r]||(i[r]={}),i=i[r]):i[r]=a}else alert("shader name of "+t+" is not valid")}},{key:"_initBuffers",value:function(e,t,a,n){for(var i={},o=0;o<t.length;o++){var r=t[o];r.attribLocations.vertexNormal&&(i.vertexNormal=!0),r.attribLocations.vertexTangent&&(i.vertexTangent=!0),r.attribLocations.vertexBitangent&&(i.vertexBitangent=!0),r.attribLocations.textureCoord&&(i.textureCoord=!0),r.attribLocations.vertexColor&&(i.vertexColor=!0)}for(var s=T.b(),c=T.b(),l=T.b(),h=[],u=0;u<n;u++)h.push({positions:[],normals:[],tangents:[],bitangents:[],textureCoordinates:[],colors:[],indices:[],offset:0});var d=function(e,t,a,n,o){var r,u=r=o&&o.bufferIndex?h[o.bufferIndex]:h[0],d=u.positions,f=u.normals,m=u.tangents,g=u.bitangents,p=u.textureCoordinates,v=u.colors,b=u.indices,x=u.offset;d.push.apply(d,Object(C.a)(e).concat(Object(C.a)(t),Object(C.a)(a),Object(C.a)(n))),b.push(x+0,x+1,x+2,x+2,x+3,x+0),r.offset+=4,(i.vertexNormal||i.vertexTangent||i.vertexBitangent)&&(T.e(c,t,e),T.e(l,n,e),i.vertexNormal&&(T.c(s,c,l),T.d(s,s),f.push.apply(f,Object(C.a)(s).concat(Object(C.a)(s),Object(C.a)(s),Object(C.a)(s)))),i.vertexTangent&&(T.d(c,c),m.push.apply(m,Object(C.a)(c).concat(Object(C.a)(c),Object(C.a)(c),Object(C.a)(c)))),i.vertexBitangent&&(T.d(l,l),g.push.apply(g,Object(C.a)(l).concat(Object(C.a)(l),Object(C.a)(l),Object(C.a)(l))))),i.textureCoord&&p.push(0,0,1,0,1,1,0,1),i.vertexColor&&v.push.apply(v,Object(C.a)(o.color).concat(Object(C.a)(o.color),Object(C.a)(o.color),Object(C.a)(o.color)))},f=function(e,t,a){switch(t.length){case 3:!function(e,t,a,n){var o,r=o=n.bufferIndex?h[n.bufferIndex]:h[0],u=r.positions,d=r.normals,f=r.tangents,m=r.bitangents,g=r.colors,p=r.indices,v=r.offset;u.push.apply(u,Object(C.a)(e).concat(Object(C.a)(t),Object(C.a)(a))),p.push(v+0,v+1,v+2),o.offset+=3,(i.vertexNormal||i.vertexTangent||i.vertexBitangent)&&(T.e(c,t,e),T.e(l,a,e),i.vertexNormal&&(T.c(s,c,l),T.d(s,s),d.push.apply(d,Object(C.a)(s).concat(Object(C.a)(s),Object(C.a)(s)))),i.vertexTangent&&(T.d(c,c),f.push.apply(f,Object(C.a)(c).concat(Object(C.a)(c),Object(C.a)(c)))),i.vertexBitangent&&(T.d(l,l),m.push.apply(m,Object(C.a)(l).concat(Object(C.a)(l),Object(C.a)(l))))),i.vertexColor&&g.push.apply(g,Object(C.a)(n.color).concat(Object(C.a)(n.color),Object(C.a)(n.color)))}(e[t[0]],e[t[1]],e[t[2]],a);break;case 4:d(e[t[0]],e[t[1]],e[t[2]],e[t[3]],a);break;case 5:!function(e,t,a,n,o,r){var u,d=u=r.bufferIndex?h[r.bufferIndex]:h[0],f=d.positions,m=d.normals,g=d.tangents,p=d.bitangents,v=d.colors,b=d.indices,x=d.offset;f.push.apply(f,Object(C.a)(e).concat(Object(C.a)(t),Object(C.a)(a),Object(C.a)(n),Object(C.a)(o))),b.push(x+0,x+3,x+4,x+0,x+1,x+3,x+1,x+2,x+3),u.offset+=5,(i.vertexNormal||i.vertexTangent||i.vertexBitangent)&&(T.e(c,t,e),T.e(l,o,e),i.vertexNormal&&(T.c(s,c,l),T.d(s,s),m.push.apply(m,Object(C.a)(s).concat(Object(C.a)(s),Object(C.a)(s),Object(C.a)(s),Object(C.a)(s)))),i.vertexTangent&&(T.d(c,c),g.push.apply(g,Object(C.a)(c).concat(Object(C.a)(c),Object(C.a)(c),Object(C.a)(c),Object(C.a)(c)))),i.vertexBitangent&&(T.d(l,l),p.push.apply(p,Object(C.a)(l).concat(Object(C.a)(l),Object(C.a)(l),Object(C.a)(l),Object(C.a)(l))))),i.vertexColor&&v.push.apply(v,Object(C.a)(r.color).concat(Object(C.a)(r.color),Object(C.a)(r.color),Object(C.a)(r.color),Object(C.a)(r.color)))}(e[t[0]],e[t[1]],e[t[2]],e[t[3]],e[t[4]],a);break;default:alert("faces with "+t.length+" vertices are not supported")}};a({addSquare:d,addFaces:function(e,t,a){for(var n=0;n<t.length;n++){var i={};a&&a.colors&&(i.color=a.colors[n%a.colors.length]),f(e,t[n],i)}}});for(var m=[],g=0;g<n;g++){var p=h[g],v=p.positions,b=p.normals,x=p.tangents,y=p.bitangents,M=p.textureCoordinates,O=p.colors,w=p.indices,L=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,L),e.bufferData(e.ARRAY_BUFFER,new Float32Array(v),e.STATIC_DRAW);var _=e.createBuffer();e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,_),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array(w),e.STATIC_DRAW);var k={position:L,indices:_,vertexCount:w.length};if(i.vertexNormal){var A=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,A),e.bufferData(e.ARRAY_BUFFER,new Float32Array(b),e.STATIC_DRAW),k.normal=A}if(i.vertexTangent){var E=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,E),e.bufferData(e.ARRAY_BUFFER,new Float32Array(x),e.STATIC_DRAW),k.tangent=E}if(i.vertexBitangent){var S=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,S),e.bufferData(e.ARRAY_BUFFER,new Float32Array(y),e.STATIC_DRAW),k.bitangent=S}if(i.textureCoord){var j=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,j),e.bufferData(e.ARRAY_BUFFER,new Float32Array(M),e.STATIC_DRAW),k.textureCoord=j}if(i.vertexColor){var R=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,R),e.bufferData(e.ARRAY_BUFFER,new Float32Array(O),e.STATIC_DRAW),k.color=R}m.push(k)}return m}},{key:"_deleteBuffers",value:function(){for(var e=this.model.buffers,t=0;t<e.length;t++){var a=e[t];for(var n in a.vertexCount=0,a)a.hasOwnProperty(n)&&"object"===typeof a[n]&&this.gl.deleteBuffer(a[n])}}},{key:"_drawModel",value:function(e){if(this.model)for(var t=this.gl,a=this.model,n=e.projectionMatrix,i=e.viewMatrix,o=e.modelMatrix,r=a.shaders,s=a.buffers,c=a.textures,l=r[e.shaderIndex?e.shaderIndex:0],h=0;h<s.length;h++){var u=s[h],d=c[h],f=e.material?e.material:e.materials?e.materials[h]:void 0,m=t.FLOAT;if(t.bindBuffer(t.ARRAY_BUFFER,u.position),t.vertexAttribPointer(l.attribLocations.vertexPosition,3,m,!1,0,0),t.enableVertexAttribArray(l.attribLocations.vertexPosition),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,u.indices),l.attribLocations.vertexNormal&&u.normal){var g=t.FLOAT;t.bindBuffer(t.ARRAY_BUFFER,u.normal),t.vertexAttribPointer(l.attribLocations.vertexNormal,3,g,!1,0,0),t.enableVertexAttribArray(l.attribLocations.vertexNormal)}if(l.attribLocations.vertexTangent&&u.tangent){var p=t.FLOAT;t.bindBuffer(t.ARRAY_BUFFER,u.tangent),t.vertexAttribPointer(l.attribLocations.vertexTangent,3,p,!1,0,0),t.enableVertexAttribArray(l.attribLocations.vertexTangent)}if(l.attribLocations.vertexBitangent&&u.bitangent){var v=t.FLOAT;t.bindBuffer(t.ARRAY_BUFFER,u.bitangent),t.vertexAttribPointer(l.attribLocations.vertexBitangent,3,v,!1,0,0),t.enableVertexAttribArray(l.attribLocations.vertexBitangent)}if(l.attribLocations.textureCoord&&u.textureCoord){var b=t.FLOAT;t.bindBuffer(t.ARRAY_BUFFER,u.textureCoord),t.vertexAttribPointer(l.attribLocations.textureCoord,2,b,!1,0,0),t.enableVertexAttribArray(l.attribLocations.textureCoord)}if(l.attribLocations.vertexColor&&u.color){var x=t.FLOAT;t.bindBuffer(t.ARRAY_BUFFER,u.color),t.vertexAttribPointer(l.attribLocations.vertexColor,3,x,!1,0,0),t.enableVertexAttribArray(l.attribLocations.vertexColor)}if(t.useProgram(l.program),t.uniformMatrix4fv(l.uniformLocations.projectionMatrix,!1,n),t.uniformMatrix4fv(l.uniformLocations.modelMatrix,!1,o),t.uniformMatrix4fv(l.uniformLocations.viewMatrix,!1,i),l.uniformLocations.normalMatrix){var y=O.a();O.c(y,o),O.h(y,y),t.uniformMatrix4fv(l.uniformLocations.normalMatrix,!1,y)}if(l.uniformLocations.showDiffuseMap&&void 0!==e.showDiffuseMap&&t.uniform1i(l.uniformLocations.showDiffuseMap,e.showDiffuseMap),l.uniformLocations.showNormalMap&&void 0!==e.showNormalMap&&t.uniform1i(l.uniformLocations.showNormalMap,e.showNormalMap),l.uniformLocations.showAmbientOcclusionMap&&void 0!==e.showAmbientOcclusionMap&&t.uniform1i(l.uniformLocations.showAmbientOcclusionMap,e.showAmbientOcclusionMap),l.uniformLocations.showParallaxMap&&void 0!==e.showParallaxMap&&t.uniform1i(l.uniformLocations.showParallaxMap,e.showParallaxMap),l.uniformLocations.lightingModel&&void 0!==e.lightingModel&&t.uniform1i(l.uniformLocations.lightingModel,e.lightingModel),l.uniformLocations.parallaxHeightScale&&void 0!==e.parallaxHeightScale&&t.uniform1f(l.uniformLocations.parallaxHeightScale,e.parallaxHeightScale),l.uniformLocations.parallaxSteps&&void 0!==e.parallaxSteps&&t.uniform1i(l.uniformLocations.parallaxSteps,e.parallaxSteps),l.uniformLocations.parallaxOcclusionMapping&&void 0!==e.parallaxOcclusionMapping&&t.uniform1i(l.uniformLocations.parallaxOcclusionMapping,e.parallaxOcclusionMapping),l.uniformLocations.ambientLight&&e.ambientLight&&t.uniform3fv(l.uniformLocations.ambientLight,e.ambientLight),l.uniformLocations.directionalLight&&e.directionalLight){var M=T.a(e.directionalLight.direction);T.d(M,M),t.uniform3fv(l.uniformLocations.directionalLight.color,e.directionalLight.color),t.uniform3fv(l.uniformLocations.directionalLight.direction,M)}if(l.uniformLocations.pointLight&&e.pointLight&&(t.uniform3fv(l.uniformLocations.pointLight.color,e.pointLight.color),t.uniform3fv(l.uniformLocations.pointLight.position,e.pointLight.position),t.uniform1f(l.uniformLocations.pointLight.brightness,e.pointLight.brightness)),l.uniformLocations.lights&&e.lights)for(var w=e.lights,L=0;L<w.length;L++){var _=w[L];t.uniform3fv(l.uniformLocations.lights[L].position,_.position),t.uniform3fv(l.uniformLocations.lights[L].ambient,_.ambient),t.uniform3fv(l.uniformLocations.lights[L].diffuse,_.diffuse),t.uniform3fv(l.uniformLocations.lights[L].specular,_.specular)}l.uniformLocations.material&&f&&(t.uniform3fv(l.uniformLocations.material.ambient,f.ambient),t.uniform3fv(l.uniformLocations.material.diffuse,f.diffuse),t.uniform3fv(l.uniformLocations.material.specular,f.specular),t.uniform1f(l.uniformLocations.material.shininess,f.shininess)),l.uniformLocations.cameraPos&&e.cameraPos&&t.uniform3fv(l.uniformLocations.cameraPos,e.cameraPos),l.uniformLocations.samplerDiffuse&&d.diffuse&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,d.diffuse),t.uniform1i(l.uniformLocations.samplerDiffuse,0)),l.uniformLocations.samplerNormal&&d.normal&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,d.normal),t.uniform1i(l.uniformLocations.samplerNormal,1)),l.uniformLocations.samplerHeight&&d.height&&(t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,d.height),t.uniform1i(l.uniformLocations.samplerHeight,2)),l.uniformLocations.samplerOcclusion&&d.occlusion&&(t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,d.occlusion),t.uniform1i(l.uniformLocations.samplerOcclusion,3));var k=u.vertexCount,A=t.UNSIGNED_SHORT;t.drawElements(t.TRIANGLES,k,A,0);for(var E=t.getProgramParameter(l.program,t.ACTIVE_ATTRIBUTES),S=0;S<E;S++)t.disableVertexAttribArray(S)}}}]),e}();function R(e){return"tetrahedron"===e?function(){var e=Math.sqrt(3),t=Math.sqrt(6);return{vertices:[[e/3,-t/3*.333+.025*t,0],[-e/6,-t/3*.333+.025*t,.5],[-e/6,-t/3*.333+.025*t,-.5],[0,t/3*.666+.025*t,0]],faces:[[0,1,2],[3,1,0],[3,0,2],[3,2,1]]}}():"cube"===e?function(){var e=.35;return{vertices:[[-e,-e,-e],[-e,-e,e],[e,-e,e],[e,-e,-e],[-e,e,-e],[-e,e,e],[e,e,e],[e,e,-e]],faces:[[0,3,2,1],[4,5,6,7],[0,1,5,4],[2,3,7,6],[1,2,6,5],[3,0,4,7]]}}():"octahedron"===e?function(){var e=1/(2*Math.sqrt(2))*1.3;return{vertices:[[-e,0,e],[e,0,e],[e,0,-e],[-e,0,-e],[0,.65,0],[0,-.65,0]],faces:[[3,0,4],[2,3,4],[1,2,4],[0,1,4],[3,2,5],[0,3,5],[2,1,5],[1,0,5]]}}():"pentagonaltrapezohedron"===e?function(){for(var e=.05,t=[],a=Math.PI/5,n=0;n<2*Math.PI;n+=a){var i=.5*Math.cos(n),o=.5*Math.sin(n);t.push([i,e,o]),e=-e}return t.push([0,.7,0]),t.push([0,-.7,0]),{vertices:t,faces:[[10,2,1,0],[10,4,3,2],[10,6,5,4],[10,8,7,6],[10,0,9,8],[11,1,2,3],[11,3,4,5],[11,5,6,7],[11,7,8,9],[11,9,0,1]]}}():"dodecahedron"===e?function(){var e=(1+Math.sqrt(5))/2,t=.5,a=.5/e,n=.5*(2-e);return{vertices:[[n,0,t],[-n,0,t],[-a,a,a],[0,t,n],[a,a,a],[a,-a,a],[0,-t,n],[-a,-a,a],[n,0,-t],[-n,0,-t],[-a,-a,-a],[0,-t,-n],[a,-a,-a],[a,a,-a],[0,t,-n],[-a,a,-a],[t,n,0],[-t,n,0],[-t,-n,0],[t,-n,0]],faces:[[4,3,2,1,0],[7,6,5,0,1],[12,11,10,9,8],[15,14,13,8,9],[14,3,4,16,13],[3,14,15,17,2],[11,6,7,18,10],[6,11,12,19,5],[4,0,5,19,16],[12,8,13,16,19],[15,9,10,18,17],[7,1,2,17,18]]}}():"icosahedron"===e?P():"icosphere"===e?function(e){var t=P(),a=t.faces,n=t.vertices,i={},o=function(e){var t=1.8666666666666667*Math.hypot(e[0],e[1],e[2]);e[0]/=t,e[1]/=t,e[2]/=t},r=function(e,t){var a;if(i[a=e<t?e+"_"+t:t+"_"+e])return i[a];var r=[(n[e][0]+n[t][0])/2,(n[e][1]+n[t][1])/2,(n[e][2]+n[t][2])/2];return o(r),n.push(r),i[a]=n.length-1,n.length-1},s=!0,c=!1,l=void 0;try{for(var h,u=n[Symbol.iterator]();!(s=(h=u.next()).done);s=!0){var d=h.value;o(d)}}catch(w){c=!0,l=w}finally{try{s||null==u.return||u.return()}finally{if(c)throw l}}for(var f=0;f<e;f++)for(var m=a.length,g=0;g<m;g++){var p=a[g],v=p[0],b=p[1],x=p[2],y=r(v,b),M=r(b,x),O=r(x,v);p[0]=y,p[1]=M,p[2]=O,a.push([v,y,O]),a.push([b,M,y]),a.push([x,O,M])}return{vertices:n,faces:a}}(3):void 0}function P(){var e=.5,t=1/(2*((1+Math.sqrt(5))/2));return{vertices:[[0,t,-e],[t,e,0],[-t,e,0],[0,t,e],[0,-t,e],[-e,0,t],[e,0,t],[0,-t,-e],[e,0,-t],[-e,0,-t],[t,-e,0],[-t,-e,0]],faces:[[1,0,2],[2,3,1],[4,3,5],[6,3,4],[7,0,8],[9,0,7],[10,4,11],[11,7,10],[5,2,9],[9,11,5],[8,1,6],[6,10,8],[5,3,2],[1,3,6],[2,0,9],[8,0,1],[9,7,11],[10,7,8],[11,4,5],[6,4,10]]}}var D=function(e){function t(e,a,n){var i;return Object(s.a)(this,t),(i=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,i.draw=i.draw.bind(Object(u.a)(i)),i._initModel({gl:e,geometry:function(e){var t=e.addFaces,i=R(a);t(i.vertices,i.faces,{colors:n})},shader:{vertex:"shaders/color_L/vertex.glsl",fragment:"shaders/color_L/fragment.glsl"}}),i}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.ambientLight,o=n.directionalLight,r=n.pointLight,s=n.cameraPos,c=n.lightingModel;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,ambientLight:i,directionalLight:o,pointLight:r,cameraPos:s,lightingModel:c})}}]),t}(j),I=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.initScene=this.initScene.bind(this),this.drawScene=this.drawScene.bind(this),this.renderOptions={ambientLight:[.2,.2,.2],directionalLight:{color:[0,0,0],direction:[0,0,0]},pointLight:{color:[1,1,1],position:[0,0,0],brightness:25},cameraPos:[0,0,0],lightingModel:0},this.options=[{description:"Colored dodecahedron and icosahedron with your choice of lighting",type:"description"},{name:"Lighting Model",id:"lightingModel",type:"select",options:["Unlit","Vertex Lighting","Fragment Lighting"],value:this.renderOptions.lightingModel}]}return Object(c.a)(e,[{key:"setOption",value:function(e,t){e.value=Number(t),this.renderOptions[e.id]=e.value}},{key:"initScene",value:function(){var e=this.gl,t=[[1,0,0],[0,0,1],[0,1,0],[1,1,0],[0,1,1],[1,0,1],[1,.5,0],[0,1,.5],[1,0,.5],[.5,1,0],[0,.5,1],[.5,0,1],[1,.5,.5],[.5,1,.5],[.5,.5,1],[1,1,.5],[1,.5,1],[.5,1,1],[.5,.5,.5],[1,1,1]],a=new D(e,"dodecahedron",t),n=new D(e,"icosahedron",t);this.scene={actors:[{model:a,location:[-1.6,0,-6],scale:[2.8,2.8,2.8],rotations:[{angle:0,axis:[1,0,0],speed:.4},{angle:0,axis:[0,1,0],speed:.2}]},{model:n,location:[1.6,0,-6],scale:[2.8,2.8,2.8],rotations:[{angle:0,axis:[1,0,0],speed:.4},{angle:0,axis:[0,1,0],speed:.2}]}],camera:[0,0,0]}}},{key:"drawScene",value:function(e){var t=this.gl,a=this.scene;E(t);var n=45*Math.PI/180,i=t.canvas.clientWidth/t.canvas.clientHeight,o=O.a();O.d(o,n,i,.1,100);var r=O.a();O.g(r,r,a.camera),O.c(r,r);for(var s=0;s<a.actors.length;s++){var c=a.actors[s];this._renderActor(o,r,c),this._animateActor(e,c)}}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location),a.scale&&O.f(i,i,a.scale);for(var o=0;o<a.rotations.length;o++){var r=a.rotations[o];O.e(i,i,r.angle,r.axis)}n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){for(var a=0;a<t.rotations.length;a++){var n=t.rotations[a];n.angle+=e*n.speed}}}]),e}(),F=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,n.draw=n.draw.bind(Object(u.a)(n)),n._initModel({gl:e,geometry:n._geometry,texture:{diffuse:a},shader:{vertex:"shaders/texture_LD/vertex.glsl",fragment:"shaders/texture_LD/fragment.glsl"}}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.ambientLight,o=n.directionalLight,r=n.pointLight,s=n.cameraPos,c=n.lightingModel;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,ambientLight:i,directionalLight:o,pointLight:r,cameraPos:s,lightingModel:c})}},{key:"_geometry",value:function(e){var t=e.addSquare,a=[-1,-1,1],n=[1,-1,1],i=[1,1,1],o=[-1,1,1],r=[-1,-1,-1],s=[1,-1,-1],c=[1,1,-1],l=[-1,1,-1];t(a,n,i,o),t(s,r,l,c),t(r,a,o,l),t(n,s,c,i),t(r,s,n,a),t(c,l,o,i)}}]),t}(j),B=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.initScene=this.initScene.bind(this),this.drawScene=this.drawScene.bind(this),this.renderOptions={ambientLight:[.2,.2,.2],directionalLight:{color:[0,0,0],direction:[0,0,0]},pointLight:{color:[1,1,1],position:[0,0,0],brightness:25},cameraPos:[0,0,0],lightingModel:0},this.options=[{description:"Textured cubes with diffuse maps only with your choice of lighting",type:"description"},{name:"Lighting Model",id:"lightingModel",type:"select",options:["Unlit","Vertex Lighting","Fragment Lighting"],value:this.renderOptions.lightingModel}],this.credits=["Textures created by Jo\xe3o Paulo","link:https://3dtextures.me/about/"]}return Object(c.a)(e,[{key:"setOption",value:function(e,t){e.value=Number(t),this.renderOptions[e.id]=e.value}},{key:"initScene",value:function(){this.scene={actors:[{model:new F(this.gl,"images/Tiles_035_basecolor.jpg"),location:[-1.6,0,-6],rotations:[{angle:0,axis:[1,0,0],speed:.4},{angle:0,axis:[0,1,0],speed:.2}]},{model:new F(this.gl,"images/Wood_planks_011_basecolor.jpg"),location:[1.6,0,-6],rotations:[{angle:0,axis:[1,0,0],speed:.4},{angle:0,axis:[0,1,0],speed:.2}]}],camera:[0,0,0]}}},{key:"drawScene",value:function(e){var t=this.gl,a=this.scene;E(t);var n=45*Math.PI/180,i=t.canvas.clientWidth/t.canvas.clientHeight,o=O.a();O.d(o,n,i,.1,100);var r=O.a();O.g(r,r,a.camera),O.c(r,r);for(var s=0;s<a.actors.length;s++){var c=a.actors[s];this._renderActor(o,r,c),this._animateActor(e,c)}}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location);for(var o=0;o<a.rotations.length;o++){var r=a.rotations[o];O.e(i,i,r.angle,r.axis)}n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){for(var a=0;a<t.rotations.length;a++){var n=t.rotations[a];n.angle+=e*n.speed}}}]),e}(),N={emerald:{ambient:[.0215,.1745,.0215],diffuse:[.07568,.61424,.07568],specular:[.633,.727811,.633],shininess:.6},jade:{ambient:[.135,.2225,.1575],diffuse:[.54,.89,.63],specular:[.316228,.316228,.316228],shininess:.1},obsidian:{ambient:[.05375,.05,.06625],diffuse:[.18275,.17,.22525],specular:[.332741,.328634,.346435],shininess:.3},pearl:{ambient:[.25,.20725,.20725],diffuse:[1,.829,.829],specular:[.296648,.296648,.296648],shininess:.088},ruby:{ambient:[.1745,.01175,.01175],diffuse:[.61424,.04136,.04136],specular:[.727811,.626959,.626959],shininess:.6},turquoise:{ambient:[.1,.18725,.1745],diffuse:[.396,.74151,.69102],specular:[.297254,.30829,.306678],shininess:.1},brass:{ambient:[.329412,.223529,.027451],diffuse:[.780392,.568627,.113725],specular:[.992157,.941176,.807843],shininess:.21794872},bronze:{ambient:[.2125,.1275,.054],diffuse:[.714,.4284,.18144],specular:[.393548,.271906,.166721],shininess:.2},chrome:{ambient:[.25,.25,.25],diffuse:[.4,.4,.4],specular:[.774597,.774597,.774597],shininess:.6},copper:{ambient:[.19125,.0735,.0225],diffuse:[.7038,.27048,.0828],specular:[.256777,.137622,.086014],shininess:.1},gold:{ambient:[.24725,.1995,.0745],diffuse:[.75164,.60648,.22648],specular:[.628281,.555802,.366065],shininess:.4},silver:{ambient:[.19225,.19225,.19225],diffuse:[.50754,.50754,.50754],specular:[.508273,.508273,.508273],shininess:.4},blackPlastic:{ambient:[0,0,0],diffuse:[.01,.01,.01],specular:[.5,.5,.5],shininess:.25},cyanPlastic:{ambient:[0,.1,.06],diffuse:[0,.50980392,.50980392],specular:[.50196078,.50196078,.50196078],shininess:.25},greenPlastic:{ambient:[0,0,0],diffuse:[.1,.35,.1],specular:[.45,.55,.45],shininess:.25},redPlastic:{ambient:[0,0,0],diffuse:[.5,0,0],specular:[.7,.6,.6],shininess:.25},whitePlastic:{ambient:[0,0,0],diffuse:[.55,.55,.55],specular:[.7,.7,.7],shininess:.25},yellowPlastic:{ambient:[0,0,0],diffuse:[.5,.5,0],specular:[.6,.6,.5],shininess:.25},blackRubber:{ambient:[.02,.02,.02],diffuse:[.01,.01,.01],specular:[.4,.4,.4],shininess:.078125},cyanRubber:{ambient:[0,.05,.05],diffuse:[.4,.5,.5],specular:[.04,.7,.7],shininess:.078125},greenRubber:{ambient:[0,.05,0],diffuse:[.4,.5,.4],specular:[.04,.7,.04],shininess:.078125},redRubber:{ambient:[.05,0,0],diffuse:[.5,.4,.4],specular:[.7,.04,.04],shininess:.078125},whiteRubber:{ambient:[.05,.05,.05],diffuse:[.5,.5,.5],specular:[.7,.7,.7],shininess:.078125},yellowRubber:{ambient:[.05,.05,0],diffuse:[.5,.5,.4],specular:[.7,.7,.04],shininess:.078125}};function U(){var e=[];for(var t in N)N.hasOwnProperty(t)&&e.push(t);return e}function z(e){return N[e]}var V=[{x:-1,y:0},{x:0,y:-1},{x:1,y:0},{x:0,y:1}];function W(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,n=function(e){s[e.y][e.x]=0},i=function(e,t){if(!o(r(e,t,3)))return!1;var a=r(e,t,2);return 1===s[a.y][a.x]},o=function(a){return!(a.x<0||a.y<0||a.x>=e||a.y>=t)},r=function(e,t,a){return{x:e.x+t.x*a,y:e.y+t.y*a}},s=[],c=0;c<t;c++)s.push(new Array(e).fill(1));var l,h={x:1,y:1},u=[];for(n(h),u.push(h);u.length>0;){for(var d=u[u.length-1],f=[],m=0;m<V.length;m++){var g=V[m];i(d,g)&&f.push(g)}if(f.length>0){var p=void 0;p=f.includes(l)&&Math.random()>a?l:f[Math.floor(Math.random()*f.length)],n(r(d,p,1)),n(r(d,p,2)),u.push(r(d,p,2)),l=p}else u.pop(),l=null}return{width:e,height:t,data:s}}function H(e,t){for(var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.8,n=[],i=0,o=[],r=0;r<t;r++)o.push(new Array(e).fill(1));for(var s=function(e,t,a){e[t.y][t.x]=a,n[t.y][t.x]=i},c=o.length,l=o[0].length,h=0;h<c;h++)n.push(Array(l).fill(0));!function(e,t,a,n,i,o,r){for(var s=[],c=0;c<o;c++){var l=1+($(1,3+r)<<1),h=$(0,1+l>>1)<<1,u=l,d=l;0===$(0,1)?u+=h:d+=h;var f=1+($(0,t-u-1>>1)<<1),m=1+($(0,a-d-1>>1)<<1);if(!(f+u>t-1||m+d>a-1||u>=t/2||d>=a/2)){for(var g={x:f,y:m,width:u,height:d},p=!1,v=0;v<s.length;v++){var b=s[v];if(Z(g,b)){p=!0;break}}if(!p){s.push(g),n();for(var x=0;x<u;x++)for(var y=0;y<d;y++)i(e,{x:f+x,y:m+y},2)}}}}(o,l,c,(function(){i++}),s,256,4);for(var u=1;u<c;u+=2)for(var d=1;d<l;d+=2)1===o[u][d]&&(i++,q(o,s,{x:d,y:u},a));return function(e,t,a,n,i){for(var o=[],r=1;r<a-1;r++)for(var s=1;s<t-1;s++)if(1===e[r][s]){for(var c=[],l=0;l<V.length;l++){var h=V[l],u=i[r+h.y][s+h.x];0===u||c.includes(u)||c.push(u)}c.length<2||o.push({x:s,y:r,regions:c})}for(var d=[0],f=[],m=1;m<=n;m++)d.push(m),f.push(m);var g=function(){var t=$(0,o.length-1),a=o[t];K(e,{x:a.x,y:a.y});for(var i=a.regions.map((function(e){return d[e]})),r=i[0],s=i.slice(1),c=0;c<=n;c++)s.includes(c)&&(d[c]=r);f=f.filter((function(e){return!s.includes(e)})),o=o.filter((function(t){if(Math.abs(t.x-a.x)<=1&&Math.abs(t.y-a.y)<=1)return!1;t.regions=t.regions.map((function(e){return d[e]}));for(var n=1;n<t.regions.length;n++)if(t.regions[n]!==t.regions[0])return!0;return 0===$(0,99)&&K(e,{x:t.x,y:t.y}),!1}))};for(;f.length>1;)g()}(o,l,c,i,n),function(e,t,a){var n=!1;for(;!n;){n=!0;for(var i=1;i<a-1;i++)for(var o=1;o<t-1;o++)if(1!==e[i][o]){for(var r=0,s=0;s<V.length;s++){var c=V[s];1!==e[i+c.y][o+c.x]&&r++}1===r&&(n=!1,G(e,{x:o,y:i}))}}}(o,l,c),{width:e,height:t,data:o}}function Y(e){for(var t=e.width,a=e.height,n=e.data,i=[],o=-t/2,r=-a/2,s=0;s<a;s++)for(var c=0;c<t;c++)1===n[s][c]&&i.push({x1:c+o,y1:s+r,x2:c+o+1,y2:s+r+1});return i}function X(e,t,a,n){return[t+-e.width/2+.5,n,a+-e.height/2+.5]}function q(e,t,a,n){var i,o=e.length,r=e[0].length,s=[];for(t(e,a,0),e[a.y][a.x]=0,s.push(a);s.length>0;){for(var c=s[s.length-1],l=[],h=0;h<V.length;h++){var u=V[h];J(e,r,o,c,u)&&l.push(u)}if(l.length>0){var d=void 0,f=Q(c,d=l.includes(i)&&Math.random()>n?i:l[Math.floor(Math.random()*l.length)],1),m=Q(c,d,2);t(e,f,0),t(e,m,0),s.push(Q(c,d,2)),i=d}else s.pop(),i=null}}function K(e,t){e[t.y][t.x]=0}function G(e,t){e[t.y][t.x]=1}function J(e,t,a,n,i){if(!function(e,t,a){if(a.x<0||a.y<0||a.x>=e||a.y>=t)return!1;return!0}(t,a,Q(n,i,3)))return!1;var o=Q(n,i,2);return 1===e[o.y][o.x]}function Q(e,t,a){return{x:e.x+t.x*a,y:e.y+t.y*a}}function $(e,t){return Math.floor(Math.random()*(t-e+1))+e}function Z(e,t){return!(e.x>t.x+t.width||t.x>e.x+e.width)&&!(e.y>t.y+t.height||t.y>e.y+e.height)}var ee=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,n.draw=n.draw.bind(Object(u.a)(n)),n.update=n.update.bind(Object(u.a)(n)),n._geometry=n._geometry.bind(Object(u.a)(n)),n.maze=a,n._initModel({gl:e,geometry:n._geometry,bufferCount:3,shaders:[{vertex:"shaders/color_L/vertex.glsl",fragment:"shaders/color_L/fragment.glsl"},{vertex:"shaders/material_L/vertex.glsl",fragment:"shaders/material_L/fragment.glsl"}]}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.shaderIndex,o=n.lights,r=n.material,s=n.materials,c=n.ambientLight,l=n.directionalLight,h=n.pointLight,u=n.lightingModel;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,shaderIndex:i,lights:o,material:r,materials:s,ambientLight:c,directionalLight:l,pointLight:h,lightingModel:u})}},{key:"update",value:function(e){this.maze=e,this._updateModel(this._geometry)}},{key:"_geometry",value:function(e){for(var t=e.addSquare,a=this.maze,n=[.2,.2,.2],i=[.7,.7,.7],o=[.5,0,.5],r=[0,.5,0],s=[.5,0,0],c=[0,0,.5],l=-a.width/2,h=-a.height/2,u=0;u<a.height;u++)for(var d=0;d<a.width;d++){var f=d+l,m=f+1,g=u+h,p=g+1,v=[f,1,p],b=[m,1,p],x=[m,0,p],y=[f,0,p],M=[f,1,g],O=[m,1,g],w=[m,0,g],L=[f,0,g];1!==a.data[u][d]?t(w,L,y,x,{color:n,bufferIndex:1}):(t(O,M,v,b,{color:i,bufferIndex:2}),0!==u&&1===a.data[u-1][d]||t(M,O,w,L,{color:o}),0!==d&&1===a.data[u][d-1]||t(v,M,L,y,{color:s}),u!==a.height-1&&1===a.data[u+1][d]||t(b,v,y,x,{color:r}),d!==a.width-1&&1===a.data[u][d+1]||t(O,b,x,w,{color:c}))}}}]),t}(j),te=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.initScene=this.initScene.bind(this),this.createMaze=this.createMaze.bind(this),this.createDungeon=this.createDungeon.bind(this),this.drawScene=this.drawScene.bind(this),this.totalDelta=0,this.renderOptions={lights:[{position:[10,-10,0],ambient:[.2,.2,.2],diffuse:[.5,.5,.5],specular:[.9,.9,.9]},{position:[-10,10,0],ambient:[.2,.2,.2],diffuse:[.5,.5,.5],specular:[.9,.9,.9]}],ambientLight:[.2,.2,.2],directionalLight:{color:[1,1,1],direction:[-1,-1,0]},pointLight:{color:[1,1,1]},useMaterials:!1,materials:new Array(3).fill(void 0),lightingModel:0},this.options=[{description:"Random maze/dungeon geometry with colors or materials using Phong shading with your choice of lighting",type:"description"},{name:"Use Materials",id:"useMaterials",type:"bool",value:this.renderOptions.useMaterials},{name:"Wall Material",type:"select",options:U()},{name:"Floor Material",type:"select",options:U()},{name:"Ceiling Material",type:"select",options:U()},{name:"Lighting Model",id:"lightingModel",type:"select",options:["Unlit","Vertex Lighting","Fragment Lighting"],value:this.renderOptions.lightingModel},{name:"Create Maze",type:"function",function:this.createMaze},{name:"Create Dungeon",type:"function",function:this.createDungeon}],this.setOption(this.options[2],0),this.setOption(this.options[3],9),this.setOption(this.options[4],10),this.credits=["Maze generation is based on this article","link:https://journal.stuffwithstuff.com/2014/12/21/rooms-and-mazes/"]}return Object(c.a)(e,[{key:"setOption",value:function(e,t){if(e.value=Number(t),e.id&&(this.renderOptions[e.id]=e.value),"Wall Material"===e.name){var a=e.options[e.value];this.renderOptions.materials[0]=z(a)}if("Floor Material"===e.name){var n=e.options[e.value];this.renderOptions.materials[1]=z(n)}if("Ceiling Material"===e.name){var i=e.options[e.value];this.renderOptions.materials[2]=z(i)}}},{key:"initScene",value:function(){var e=this.gl,t=this._generateMaze(),a=t.size,n=t.maze,i=new ee(e,n);this.scene={actors:[{model:i,location:[0,0,-2*a],rotation:{angle:0,axis:[0,1,0],speed:.5}}],camera:[0,0,0]},this.renderOptions.pointLight.position=[0,a,-2*a],this.renderOptions.pointLight.brightness=a*a}},{key:"createMaze",value:function(){var e=this._generateMaze(),t=e.size,a=e.maze;this.scene.actors[0].location=[0,0,-2*t],this.scene.actors[0].model.update(a),this.renderOptions.pointLight.position=[0,10,-2*t]}},{key:"_generateMaze",value:function(){var e=2*Math.floor(35*Math.random())+11;return{size:e,maze:W(e,e)}}},{key:"createDungeon",value:function(){var e=this._generateDungeon(),t=e.size,a=e.maze;this.scene.actors[0].location=[0,0,-2*t],this.scene.actors[0].model.update(a),this.renderOptions.pointLight.position=[0,10,-2*t]}},{key:"_generateDungeon",value:function(){var e=2*Math.floor(35*Math.random())+11;return{size:e,maze:H(e,e)}}},{key:"drawScene",value:function(e){var t=this.gl,a=this.scene;E(t);var n=45*Math.PI/180,i=t.canvas.clientWidth/t.canvas.clientHeight,o=O.a();O.d(o,n,i,.1,500);var r=O.a();O.g(r,r,a.camera),O.c(r,r);for(var s=0;s<a.actors.length;s++){var c=a.actors[s];this._renderActor(o,r,c),this._animateActor(e,c)}}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location),O.e(i,i,w(45),[1,0,0]),O.e(i,i,a.rotation.angle,a.rotation.axis),this.renderOptions.useMaterials?this.renderOptions.shaderIndex=1:this.renderOptions.shaderIndex=0,n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){t.rotation.angle+=e*t.rotation.speed}}]),e}(),ae=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,a.draw=a.draw.bind(Object(u.a)(a)),a._initModel({gl:e,geometry:a._geometry,texture:{diffuse:"images/Brick_Wall_017_basecolor.jpg",normal:"images/Brick_Wall_017_normal.jpg",height:"images/Brick_Wall_017_height.png",occlusion:"images/Brick_Wall_017_ambientOcclusion.jpg"},shader:{vertex:"shaders/texture_LDNOP/vertex.glsl",fragment:"shaders/texture_LDNOP/fragment.glsl"}}),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.showDiffuseMap,o=n.showNormalMap,r=n.showAmbientOcclusionMap,s=n.showParallaxMap,c=n.parallaxHeightScale,l=n.parallaxSteps,h=n.parallaxOcclusionMapping;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,showDiffuseMap:i,showNormalMap:o,showAmbientOcclusionMap:r,showParallaxMap:s,parallaxHeightScale:c,parallaxSteps:l,parallaxOcclusionMapping:h,ambientLight:[.3,.3,.3],directionalLight:{color:[.4,.4,.4],direction:[0,-1,1]},pointLight:{color:[1,1,1],position:[0,0,0],brightness:15},cameraPos:[0,0,0]})}},{key:"_geometry",value:function(e){var t=e.addSquare,a=[-1,-1,1],n=[1,-1,1],i=[1,1,1],o=[-1,1,1],r=[-1,-1,-1],s=[1,-1,-1],c=[1,1,-1],l=[-1,1,-1];t(a,n,i,o),t(s,r,l,c),t(r,a,o,l),t(n,s,c,i),t(r,s,n,a),t(c,l,o,i)}}]),t}(j),ne=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.initScene=this.initScene.bind(this),this.drawScene=this.drawScene.bind(this),this.renderOptions={showDiffuseMap:!0,showNormalMap:!0,showAmbientOcclusionMap:!0,showParallaxMap:!0,parallaxHeightScale:.04,parallaxSteps:32,parallaxOcclusionMapping:!0},this.options=[{description:"Brick cube with diffuse, normal, ambient occlusion, and parallax maps",type:"description"},{name:"Show Diffuse Map",id:"showDiffuseMap",type:"bool"},{name:"Show Normal Map",id:"showNormalMap",type:"bool"},{name:"Show Ambient Occlusion Map",id:"showAmbientOcclusionMap",type:"bool"},{name:"Show Parallax Map",id:"showParallaxMap",type:"bool"},{name:"Parallax Height Scale",id:"parallaxHeightScale",type:"float",min:0,max:.1},{name:"Parallax Steps",id:"parallaxSteps",type:"int",min:0,max:32},{name:"Use Parallax Occlusion Mapping",id:"parallaxOcclusionMapping",type:"bool"}];for(var a=0;a<this.options.length;a++)this.options[a].value=this.renderOptions[this.options[a].id];this.credits=["Textures created by Jo\xe3o Paulo","link:https://3dtextures.me/about/"]}return Object(c.a)(e,[{key:"setOption",value:function(e,t){e.value=Number(t),this.renderOptions[e.id]=e.value}},{key:"initScene",value:function(){var e=this.gl,t=new ae(e);this.scene={actors:[{model:t,location:[0,0,-5.5],rotations:[{angle:0,axis:[0,1,0],speed:.4},{angle:0,axis:[1,0,0],speed:.2}]}],camera:[0,0,0]}}},{key:"drawScene",value:function(e){var t=this.gl,a=this.scene;E(t);var n=45*Math.PI/180,i=t.canvas.clientWidth/t.canvas.clientHeight,o=O.a();O.d(o,n,i,.1,100);var r=O.a();O.g(r,r,a.camera),O.c(r,r);for(var s=0;s<a.actors.length;s++){var c=a.actors[s];this._renderActor(o,r,c),this._animateActor(e,c)}}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location);for(var o=0;o<a.rotations.length;o++){var r=a.rotations[o];O.e(i,i,r.angle,r.axis)}n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){for(var a=0;a<t.rotations.length;a++){var n=t.rotations[a];n.angle+=e*n.speed}}}]),e}(),ie=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,n.draw=n.draw.bind(Object(u.a)(n)),n._initModel({gl:e,geometry:function(e){var t=e.addFaces,n=R(a);t(n.vertices,n.faces)},shader:{vertex:"shaders/material_L/vertex.glsl",fragment:"shaders/material_L/fragment.glsl"}}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.cameraPos,o=n.lights,r=n.material,s=n.lightingModel;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,cameraPos:i,lights:o,material:r,lightingModel:s})}}]),t}(j),oe=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.initScene=this.initScene.bind(this),this.drawScene=this.drawScene.bind(this),this.renderOptions={lights:[{position:[10,-10,0],ambient:[.2,.2,.2],diffuse:[.5,.5,.5],specular:[.9,.9,.9]},{position:[-10,10,0],ambient:[.2,.2,.2],diffuse:[.5,.5,.5],specular:[.9,.9,.9]}],materials:new Array(3).fill(0),lightingModel:2};var a=U();this.options=[{description:"Various solid geometries with various materials using Phong shading",type:"description"},{name:"Material 1",type:"select",options:a},{name:"Material 2",type:"select",options:a},{name:"Material 3",type:"select",options:a}],this.setOption(this.options[1],8),this.setOption(this.options[2],10),this.setOption(this.options[3],2)}return Object(c.a)(e,[{key:"setOption",value:function(e,t){if(e.value=Number(t),e.id&&(this.renderOptions[e.id]=e.value),"Material 1"===e.name){var a=e.options[e.value];this.renderOptions.materials[0]=z(a)}else if("Material 2"===e.name){var n=e.options[e.value];this.renderOptions.materials[1]=z(n)}else if("Material 3"===e.name){var i=e.options[e.value];this.renderOptions.materials[2]=z(i)}}},{key:"initScene",value:function(){var e=this.gl,t=new ie(e,"tetrahedron"),a=new ie(e,"cube"),n=new ie(e,"octahedron"),i=new ie(e,"pentagonaltrapezohedron"),o=new ie(e,"dodecahedron"),r=new ie(e,"icosahedron");this.scene={actors:[{model:t,materialIndex:1,location:[-3.75,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:a,materialIndex:1,location:[-2.25,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:n,materialIndex:1,location:[-.75,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:i,materialIndex:1,location:[.75,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:o,materialIndex:1,location:[2.25,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:r,materialIndex:1,location:[3.75,0,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:t,materialIndex:0,location:[-3.75,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:a,materialIndex:0,location:[-2.25,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:n,materialIndex:0,location:[-.75,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:i,materialIndex:0,location:[.75,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:o,materialIndex:0,location:[2.25,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:r,materialIndex:0,location:[3.75,2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:t,materialIndex:2,location:[-3.75,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:a,materialIndex:2,location:[-2.25,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:n,materialIndex:2,location:[-.75,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:i,materialIndex:2,location:[.75,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:o,materialIndex:2,location:[2.25,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]},{model:r,materialIndex:2,location:[3.75,-2,-8],rotations:[{angle:0,axis:[0,1,0],speed:.8},{angle:0,axis:[1,0,0],speed:.4}]}],camera:[0,0,0]}}},{key:"drawScene",value:function(e){var t=this.gl,a=this.scene;E(t);var n=45*Math.PI/180,i=t.canvas.clientWidth/t.canvas.clientHeight,o=O.a();O.d(o,n,i,.1,100);var r=O.a();O.g(r,r,a.camera),O.c(r,r),this.renderOptions.cameraPos=a.camera;for(var s=0;s<a.actors.length;s++){var c=a.actors[s];this._renderActor(o,r,c),this._animateActor(e,c)}}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location);for(var o=0;o<a.rotations.length;o++){var r=a.rotations[o];O.e(i,i,r.angle,r.axis)}this.renderOptions.material=this.renderOptions.materials[a.materialIndex],n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){for(var a=0;a<t.rotations.length;a++){var n=t.rotations[a];n.angle+=e*n.speed}}}]),e}();function re(e,t,a,n,i,o){return(e-n)*(e-n)+(t-i)*(t-i)<(a+o)*(a+o)}function se(e,t,a,n,i,o,r){var s=a/3,c=0,l=e,h=t;e<n-s?(c|=1,l=n):e>o+s&&(c|=1,l=o),t<i-s?(c|=2,h=i):t>r+s&&(c|=2,h=r);var u=e-l,d=t-h;return u*u+d*d<=a*a?c:0}var ce=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(h.a)(t).call(this,e))).gl=e,n.map=a,n.draw=n.draw.bind(Object(u.a)(n)),n.update=n.update.bind(Object(u.a)(n)),n._geometry=n._geometry.bind(Object(u.a)(n)),n._initModel({gl:e,geometry:n._geometry,textures:[{diffuse:"images/Brick_Wall_017_basecolor.jpg",normal:"images/Brick_Wall_017_normal.jpg",height:"images/Brick_Wall_017_height.png",occlusion:"images/Brick_Wall_017_ambientOcclusion.jpg"},{diffuse:"images/Tiles_035_basecolor.jpg",normal:"images/Tiles_035_normal.jpg",height:"images/Tiles_035_height.png",occlusion:"images/Tiles_035_ambientOcclusion.jpg"},{diffuse:"images/Wood_planks_011_basecolor.jpg",normal:"images/Wood_planks_011_normal.jpg",height:"images/Wood_planks_011_height.png",occlusion:"images/Wood_planks_011_ambientOcclusion.jpg"}],shader:{vertex:"shaders/texture_LDNOP/vertex.glsl",fragment:"shaders/texture_LDNOP/fragment.glsl"}}),n}return Object(d.a)(t,e),Object(c.a)(t,[{key:"draw",value:function(e,t,a,n){var i=n.showDiffuseMap,o=n.showNormalMap,r=n.showAmbientOcclusionMap,s=n.showParallaxMap,c=n.parallaxHeightScale,l=n.parallaxSteps,h=n.parallaxOcclusionMapping,u=n.ambientLight,d=n.directionalLight,f=n.pointLight,m=n.cameraPos;this._drawModel({projectionMatrix:e,viewMatrix:t,modelMatrix:a,showDiffuseMap:i,showNormalMap:o,showAmbientOcclusionMap:r,showParallaxMap:s,parallaxHeightScale:c,parallaxSteps:l,parallaxOcclusionMapping:h,ambientLight:u,directionalLight:d,pointLight:f,cameraPos:m})}},{key:"update",value:function(e){this.map=e,this._updateModel(this._geometry)}},{key:"_geometry",value:function(e){for(var t=e.addSquare,a=this.map,n=a.width,i=a.height,o=a.data,r=function(e,t){return e<0||t<0||e>n-1||t>i-1||1===o[t][e]},s=-n/2,c=-i/2,l=0;l<i;l++)for(var h=0;h<n;h++){var u=h+s,d=u+1,f=l+c,m=f+1,g=[u,1,m],p=[d,1,m],v=[d,0,m],b=[u,0,m],x=[u,1,f],y=[d,1,f],M=[d,0,f],O=[u,0,f],w=[u,2,m],L=[d,2,m],_=[d,1,m],k=[u,1,m],A=[u,2,f],E=[d,2,f],S=[d,1,f],C=[u,1,f];if(0===o[l][h])t(M,O,b,v,{bufferIndex:1}),t(x,y,p,g,{bufferIndex:2}),0!==l&&1!==o[l-1][h]||t(y,x,O,M),0!==h&&1!==o[l][h-1]||t(x,g,b,O),l!==i-1&&1!==o[l+1][h]||t(g,p,v,b),h!==n-1&&1!==o[l][h+1]||t(p,y,M,v);else if(2===o[l][h]){for(var T=[0,0,0,0,0,0,0,0,0],j=-1;j<2;j++)for(var R=-1;R<2;R++)T[3*(j+1)+(R+1)]=r(h+R,l+j);t(M,O,b,v,{bufferIndex:1}),t(A,E,L,w,{bufferIndex:2}),T[1]?(t(y,x,O,M),t(E,A,C,S)):T[0]&&T[2]&&t(E,A,C,S),T[3]?(t(x,g,b,O),t(A,w,k,C)):T[0]&&T[6]&&t(A,w,k,C),T[7]?(t(g,p,v,b),t(w,L,_,k)):T[6]&&T[8]&&t(w,L,_,k),T[5]?(t(p,y,M,v),t(L,E,S,_)):T[2]&&T[8]&&t(L,E,S,_)}}}}]),t}(j),le=["tetrahedron","cube","octahedron","dodecahedron","icosahedron"],he=["gold","chrome","copper"],ue=function(){function e(t){Object(s.a)(this,e),this.gl=t,this.setOption=this.setOption.bind(this),this.mouseMovement=this.mouseMovement.bind(this),this.keyboardState=this.keyboardState.bind(this),this.registerDataChange=this.registerDataChange.bind(this),this.forceDataChange=this.forceDataChange.bind(this),this.initScene=this.initScene.bind(this),this.createMaze=this.createMaze.bind(this),this.createDungeon=this.createDungeon.bind(this),this.drawScene=this.drawScene.bind(this);var a=[.1,.1,.1],n={color:[.6,.6,.6],brightness:15};this.renderOptions={showDiffuseMap:!0,showNormalMap:!0,showAmbientOcclusionMap:!0,showParallaxMap:!1,parallaxHeightScale:.02,parallaxSteps:32,parallaxOcclusionMapping:!0,ambientLight:a,directionalLight:{color:[0,0,0],direction:[0,0,0]},pointLight:n,lights:[{ambient:[Math.min(2*a[0],1),Math.min(2*a[1],1),Math.min(2*a[2],1)],diffuse:n.color,specular:[Math.min(2*n.color[0],1),Math.min(2*n.color[1],1),Math.min(2*n.color[2],1)]},{ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]}],lightingModel:2},this.options=[{description:"Explorable random maze geometry with diffuse, normal, ambient occlusion, and parallax maps",type:"description"},{name:"Show Diffuse Map",id:"showDiffuseMap",type:"bool"},{name:"Show Normal Map",id:"showNormalMap",type:"bool"},{name:"Show Ambient Occlusion Map",id:"showAmbientOcclusionMap",type:"bool"},{name:"Show Parallax Map",id:"showParallaxMap",type:"bool"},{name:"Parallax Height Scale",id:"parallaxHeightScale",type:"float",min:0,max:.1},{name:"Parallax Steps",id:"parallaxSteps",type:"int",min:0,max:32},{name:"Use Parallax Occlusion Mapping",id:"parallaxOcclusionMapping",type:"bool"},{name:"Create Maze",type:"function",function:this.createMaze},{name:"Create Dungeon",type:"function",function:this.createDungeon}];for(var i=0;i<this.options.length;i++)this.options[i].value=this.renderOptions[this.options[i].id];this.credits=["Textures created by Jo\xe3o Paulo","link:https://3dtextures.me/about/","","Maze generation is based on this article","link:https://journal.stuffwithstuff.com/2014/12/21/rooms-and-mazes/"],this.movement={front:0,side:0}}return Object(c.a)(e,[{key:"setOption",value:function(e,t){e.value=Number(t),this.renderOptions[e.id]=e.value}},{key:"mouseMovement",value:function(e,t){var a=this.scene.camera;a.rotations[0].angle-=.001*e,a.rotations[1].angle-=.001*t}},{key:"keyboardState",value:function(e){var t=0;e.w&&(t-=1),e.s&&(t+=1);var a=0;e.a&&(a-=1),e.d&&(a+=1),this.movement.front=t,this.movement.side=a}},{key:"registerDataChange",value:function(e){this.onDataChange=e}},{key:"forceDataChange",value:function(){this._updatePowerUpInfo(this.scene.actors)}},{key:"initScene",value:function(){this._updateMap(this.gl,!1)}},{key:"createMaze",value:function(){this._updateMap(this.gl,!1)}},{key:"createDungeon",value:function(){this._updateMap(this.gl,!0)}},{key:"_updateMap",value:function(e,t){this.ready=!1,this.map=t?H(15,15):W(11,11);var a=function(e){for(var t=e.width,a=e.height,n=e.data,i=function(e,i){return e<0||e>=t||i<0||i>=a||1===n[i][e]},o=-t/2,r=-a/2,s=0;s<a;s++)for(var c=0;c<t;c++)if(1!==n[s][c]){for(var l=0,h=[],u=-1;u<2;u++)for(var d=-1;d<2;d++)i(c+d,s+u)?h.push("1"):h.push("0");var f=void 0,m=void 0;return"0"===h[0]?(f=c+1,m=s+1,l=-45):"0"===h[2]?(f=c-1,m=s+1,l=45):"0"===h[6]?(f=c+1,m=s-1,l=-225):"0"===h[8]?(f=c-1,m=s-1,l=225):"0"===h[3]?(f=c-1,m=s,l=90):"0"===h[5]?(f=c+1,m=s,l=-90):"0"===h[7]?(f=c,m=s+1,l=180):(f=c,m=s-1,l=0),{location:[c+o+.5,.5,s+r+.5],angle:w(l),square:{x:c,y:s},nextSquare:{x:f,y:m}}}return{location:[0,.5,0]}}(this.map),n=a.location,i=a.angle,o=a.square,r=a.nextSquare;if(this.scene)this.scene.actors.length>1&&(this.scene.actors.length=1),this.scene.actors[0].boundingRectagles=Y(this.map),this.scene.actors[0].model.update(this.map),this.scene.camera.location=n,this.scene.camera.rotations[0].angle=i;else{var s=new ce(e,this.map);this.scene={actors:[{active:!0,boundingRectagles:Y(this.map),model:s,location:[0,0,0],rotations:[]}],camera:{location:n,rotations:[{angle:i,axis:[0,1,0]},{angle:0,axis:[1,0,0]}]}}}this._placePowerUps(this.scene,this.map,o.x,o.y,r.x,r.y),this.ready=!0}},{key:"_placePowerUps",value:function(e,t,a,n,i,o){for(var r=t.width,s=t.height,c=t.data,l=0;l<s;l++)for(var h=0;h<r;h++)if(1!==c[l][h]){if(h===a&&l===n)continue;if(h===i&&l===o||Math.random()<.2){var u=X(t,h,l,.4);e.actors.push({active:!0,boundingRadius:.1,model:new ie(this.gl,S(le)),material:z(S(he)),location:u,scale:[.15,.15,.15],rotations:[{angle:0,axis:[1,0,0],speed:1+Math.random()},{angle:0,axis:[0,1,0],speed:2+Math.random()+Math.random()}]})}}this._updatePowerUpInfo(e.actors)}},{key:"_updatePowerUpInfo",value:function(e){for(var t=0,a=0,n=0;n<e.length;n++){var i=e[n];i.boundingRadius&&(a++,i.active||t++)}this.onDataChange({collected:t,total:a})}},{key:"drawScene",value:function(e){if(this.ready){var t=this.gl,a=this.scene,n=a.camera;E(t);var i=45*Math.PI/180,o=t.canvas.clientWidth/t.canvas.clientHeight,r=O.a();O.d(r,i,o,.1,100);var s=O.a();O.g(s,s,n.location);for(var c=0;c<n.rotations.length;c++){var l=n.rotations[c];O.e(s,s,l.angle,l.axis)}O.c(s,s),this.renderOptions.cameraPos=n.location,this.renderOptions.pointLight.position=n.location,this.renderOptions.lights[0].position=n.location,this.renderOptions.lights[1].position=n.location;for(var h=0;h<a.actors.length;h++){var u=a.actors[h];u.active&&(this._renderActor(r,s,u),this._animateActor(e,u))}O.b(s),O.e(s,s,n.rotations[0].angle,n.rotations[0].axis),O.c(s,s);var d=n.location[0],f=n.location[2];n.location[0]+=e*this.movement.front*s[2],n.location[1]+=e*this.movement.front*s[6],n.location[2]+=e*this.movement.front*s[10],n.location[0]+=e*this.movement.side*s[0],n.location[1]+=e*this.movement.side*s[4],n.location[2]+=e*this.movement.side*s[8],this._detectCollisions(n,d,f,a)}}},{key:"_detectCollisions",value:function(e,t,a,n){for(var i=e.location[0],o=e.location[2],r=n.actors[0].boundingRectagles,s=r.length,c=0,l=0;l<s;l++){var h=r[l];c|=se(i,o,.2,h.x1,h.y1,h.x2,h.y2)}0!==c&&(1===c?e.location[0]=t:2===c?e.location[2]=a:(e.location[0]=t,e.location[2]=a)),c=0;for(var u=0;u<n.actors.length;u++){var d=n.actors[u];d.active&&d.boundingRadius&&re(i,o,.2,d.location[0],d.location[2],d.boundingRadius)&&(c++,d.active=!1)}c>0&&this._updatePowerUpInfo(n.actors)}},{key:"_renderActor",value:function(e,t,a){var n=a.model,i=O.a();O.g(i,i,a.location),a.scale&&O.f(i,i,a.scale);for(var o=0;o<a.rotations.length;o++){var r=a.rotations[o];O.e(i,i,r.angle,r.axis)}a.material&&(this.renderOptions.material=a.material),n.draw(e,t,i,this.renderOptions)}},{key:"_animateActor",value:function(e,t){for(var a=0;a<t.rotations.length;a++){var n=t.rotations[a];n.angle+=e*n.speed}}}]),e}(),de=function(){function e(t,a){if(Object(s.a)(this,e),this.canvas=t,this.onDataChange=a,this.resizeViewport=this.resizeViewport.bind(this),this.getScene=this.getScene.bind(this),this.previousScene=this.previousScene.bind(this),this.nextScene=this.nextScene.bind(this),this.renderScene=this.renderScene.bind(this),this.gl=t.getContext("webgl"),null===this.gl)alert("Unable to initialize WebGL. Your browser or machine may not support it.");else{this.resizeViewport(),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK),this.scenes=[new I(this.gl),new B(this.gl),new oe(this.gl),new te(this.gl),new ne(this.gl),new ue(this.gl)],this.sceneIndex=0;for(var n=0;n<this.scenes.length;n++){var i=this.scenes[n];i.registerDataChange&&i.registerDataChange(this.onDataChange),i.initScene()}}}return Object(c.a)(e,[{key:"resizeViewport",value:function(){var e=this.canvas,t=e.getBoundingClientRect();e.width=t.width,e.height=t.height,this.gl.viewport(0,0,e.width,e.height)}},{key:"getScene",value:function(){return this.scenes[this.sceneIndex]}},{key:"previousScene",value:function(){this.sceneIndex=(this.sceneIndex-1)%this.scenes.length,this.sceneIndex<0&&(this.sceneIndex=this.scenes.length-1);var e=this.scenes[this.sceneIndex];return e.forceDataChange&&e.forceDataChange(),this.scenes[this.sceneIndex]}},{key:"nextScene",value:function(){this.sceneIndex=(this.sceneIndex+1)%this.scenes.length;var e=this.scenes[this.sceneIndex];return e.forceDataChange&&e.forceDataChange(),this.scenes[this.sceneIndex]}},{key:"renderScene",value:function(e){e*=.001,this.timeStamp||(this.timeStamp=e);var t=e-this.timeStamp;this.timeStamp=e,this.scenes[this.sceneIndex].drawScene(t)}}]),e}(),fe=["Click the canvas to explore the scene"],me=["Use the mouse to look","Use the WASD keys to move around"],ge=function(e){function t(e){var a;return Object(s.a)(this,t),(a=Object(l.a)(this,Object(h.a)(t).call(this,e))).onResize=a.onResize.bind(Object(u.a)(a)),a.onKeyDown=a.onKeyDown.bind(Object(u.a)(a)),a.onKeyUp=a.onKeyUp.bind(Object(u.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(u.a)(a)),a.onDataChange=a.onDataChange.bind(Object(u.a)(a)),a.onLockChange=a.onLockChange.bind(Object(u.a)(a)),a.onClickCanvas=a.onClickCanvas.bind(Object(u.a)(a)),a.onChange=a.onChange.bind(Object(u.a)(a)),a.onClickPrevious=a.onClickPrevious.bind(Object(u.a)(a)),a.onClickNext=a.onClickNext.bind(Object(u.a)(a)),a.onClickMessage=a.onClickMessage.bind(Object(u.a)(a)),a.onAnimationFrame=a.onAnimationFrame.bind(Object(u.a)(a)),a.state={showControls:!1},a.keys={},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.sceneManager=new de(this.canvas,this.onDataChange);var e=this.sceneManager.getScene(),t=e.mouseMovement?fe:void 0;this.setState({scene:e,notes:t,sceneData:void 0}),this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock,document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock,this.frame=window.requestAnimationFrame(this.onAnimationFrame),window.addEventListener("resize",this.onResize),window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp),document.addEventListener("pointerlockchange",this.onLockChange),document.addEventListener("mozpointerlockchange",this.onLockChange),this.showMessage(["Press Escape to toggle menu","Press Page Up for previous screen","Press Page Down for next screen"])}},{key:"componentWillUnmount",value:function(){window.cancelAnimationFrame(this.frame),window.removeEventListener("resize",this.onResize),window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("pointerlockchange",this.onLockChange),document.removeEventListener("mozpointerlockchange",this.onLockChange)}},{key:"cancelLock",value:function(){this.captureMouse=!1,this.captureKeys=!1,document.exitPointerLock()}},{key:"onResize",value:function(){this.sceneManager.resizeViewport()}},{key:"onKeyDown",value:function(e){e.preventDefault(),this.keys[e.key]||(this.onKeyPress(e.key),this.keys[e.key]=!0,this.captureKeys&&this.state.scene.keyboardState(this.keys))}},{key:"onKeyUp",value:function(e){e.preventDefault(),this.keys[e.key]=!1,this.captureKeys&&this.state.scene.keyboardState(this.keys)}},{key:"onKeyPress",value:function(e){if("Escape"===e)this.messageTimer?this.cancelMessage():this.setState({showControls:!this.state.showControls});else if("PageUp"===e){this.cancelLock(),this.setState({sceneData:void 0});var t=this.sceneManager.previousScene(),a=t.mouseMovement?fe:void 0;this.setState({scene:t,notes:a})}else if("PageDown"===e){this.cancelLock(),this.setState({sceneData:void 0});var n=this.sceneManager.nextScene(),i=n.mouseMovement?fe:void 0;this.setState({scene:n,notes:i})}}},{key:"onMouseMove",value:function(e){this.captureMouse&&this.state.scene.mouseMovement(e.movementX,e.movementY)}},{key:"onDataChange",value:function(e){this.setState({sceneData:e})}},{key:"onLockChange",value:function(e){e.preventDefault(),document.pointerLockElement===this.canvas||document.mozPointerLockElement===this.canvas?(document.addEventListener("mousemove",this.onMouseMove),this.captureMouse=!0,this.state.scene.keyboardState&&(this.captureKeys=!0),this.setState({notes:me})):(document.removeEventListener("mousemove",this.onMouseMove),this.captureMouse=!1,this.captureKeys=!1,this.setState({notes:void 0}))}},{key:"onClickCanvas",value:function(e){e.preventDefault(),this.state.scene.mouseMovement&&(this.canvas.requestPointerLock(),this.setState({showControls:!1,notes:void 0}))}},{key:"onChange",value:function(e,t){t!==e.value&&(this.state.scene.setOption(e,t),this.forceUpdate())}},{key:"onClickPrevious",value:function(e){e.preventDefault(),this.cancelLock(),this.setState({sceneData:void 0});var t=this.sceneManager.previousScene(),a=t.mouseMovement?fe:void 0;this.setState({scene:t,notes:a})}},{key:"onClickNext",value:function(e){e.preventDefault(),this.cancelLock(),this.setState({sceneData:void 0});var t=this.sceneManager.nextScene(),a=t.mouseMovement?fe:void 0;this.setState({scene:t,notes:a})}},{key:"onClickMessage",value:function(e){e.preventDefault(),this.messageTimer&&this.cancelMessage()}},{key:"showMessage",value:function(e){this.setState({message:e}),this.messageTimer=setTimeout(this.clearMessage.bind(this),1e4)}},{key:"clearMessage",value:function(){this.setState({message:void 0}),this.messageTimer=void 0}},{key:"cancelMessage",value:function(){clearTimeout(this.messageTimer),this.clearMessage()}},{key:"onAnimationFrame",value:function(e){this.sceneManager.renderScene(e),this.frame=window.requestAnimationFrame(this.onAnimationFrame)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",{className:"screen"},i.a.createElement("canvas",{id:"canvas",ref:function(t){return e.canvas=t},onClick:this.onClickCanvas}),i.a.createElement("div",{id:"note"},this.state.notes?this.state.notes.map((function(e,t){return i.a.createElement("div",{key:t},e)})):null,this.state.sceneData&&this.state.sceneData.total?i.a.createElement("div",null,this.state.sceneData.collected,"/",this.state.sceneData.total," power-ups collected"):null),i.a.createElement(f,{message:this.state.message,onClick:this.onClickMessage}),i.a.createElement(y,{show:this.state.showControls,onClickPrevious:this.onClickPrevious,onClickNext:this.onClickNext,onChange:this.onChange,options:this.state.scene?this.state.scene.options:void 0}),i.a.createElement(M,{show:this.state.showControls,credits:this.state.scene?this.state.scene.credits:void 0}))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[13,1,2]]]);
//# sourceMappingURL=main.170c60bc.chunk.js.map